"use strict";!function(e,t){if("ymab"in e&&"function"==typeof e.ymab&&e.ymab.inited)return;const n=100,r=1e4/n,i={},s={},o={},a={enableRedir:!0,enableVisual:!0,enableHTML:!0,enableJS:!1,enableWatch:!1,enableAdv:!1,storeRedirParam:!0,metrikaTimeout:100,nonce:void 0},c={enableRedir:["boolean"],enableVisual:["boolean"],enableHTML:["boolean"],enableJS:["boolean"],enableWatch:["boolean"],enableAdv:["boolean"],metrikaTimeout:["number"],storeRedirParam:["boolean","string"],nonce:["string"]},l={};let u="https://uaas.yandex.ru/v1/exps/";const f="_ymab_param",d=6e4,h=365*(24*(60*d)),m=/\/$/,p=e.requestAnimationFrame||function(e){setTimeout(e,10)};let b;function v(n,r,i=h){let s=`${n}=${r}; path=/; max-age=${i/1e3};`;"https:"===e.location.protocol&&(s+="SameSite=None; Secure;"),t.cookie=s}function g(e){const n=new RegExp(`(?:^|; )${e}=([^;]*)`),r=t.cookie.match(n);return r&&r[1]||void 0}function y(e,t){const n=e.indexOf(t);if(-1===n)return[];return[e.slice(0,n).trim(),e.slice(n+1)]}function _(e,t){return e.reduce(((e,{t:n,n:r,v:i})=>{if("visual"===n&&t.enableVisual){const[n,s]=y(i,"|");if(!n||void 0===s)return e;switch(r){case"css-insert":return e.cssInsert.push({selector:n,value:s}),e;case"text-insert":return e.textInsert.push({selector:n,value:s}),e;case"href-insert":return e.hrefInsert.push({selector:n,value:s}),e;case"image-insert":return e.imageSrcInsert.push({selector:n,value:s}),e;case"html-replace":if(!t.enableHTML)break;return e.htmlReplace.push({selector:n,value:s}),e;case"js-insert":if(!t.enableJS)break;return e.jsInsert.push({selector:n,value:s}),e}}if("redir"===n&&t.enableRedir)return e.redirect.push(i),e;if("adv"===n&&t.enableAdv)return e.adv.push({type:r,value:i}),e;let s=e.flags[r];return s||(e.flags[r]=s=[]),s.push(i),e}),{cssInsert:[],textInsert:[],redirect:[],hrefInsert:[],imageSrcInsert:[],htmlReplace:[],jsInsert:[],adv:[],flags:{}})}function x(e,n,r,i){try{const n=t.createElement("script");n.nonce=e,n.setAttribute("type","text/javascript"),n.innerHTML=`(function(element){${r}})(document.querySelector('${i}'));`,t.body.appendChild(n)}catch(n){}}const T={};function S(e){if(T[e])return;const n=t.createElement("script");n.async=!0,n.type="text/javascript",n.src=e;const r=t.head;r.insertBefore(n,r.firstChild),T[e]=!0}const w=new Set(["js-insert","css-insert"]),I={cache:{},getItem(e,t){let n=this.cache[e];n||(n=this.cache[e]={});let r=n[t.selector];r||(r=n[t.selector]={});let i=r[t.value];return i||(i=r[t.value]=new Set),i},has(e,t,n){return w.has(e)&&this.getItem(e,t).has(n)},add(e,t,n){return this.getItem(e,t).add(n)}};function k(e,r,i,s){const{selector:o,value:a}=i;if(!o||void 0===a)return;const c=function(e){return e?t.querySelector(e):void 0}(o);c?I.has(e,i,c)||(r(c,a,o),I.add(e,i,c)):s>0&&setTimeout((()=>k(e,r,i,s-1)),n)}function j(e,t,n,i){n.forEach((n=>k(e,t,n,i?r:0)))}const E=new class{constructor(){this.callbacks={},this.MAX_DEPTH=1e3,this.depth=0,this.started=!1,this.item=new e.MutationObserver((()=>{if(this.depth++>=this.MAX_DEPTH)return this.item.disconnect(),void p((()=>this.observe()));Object.values(this.callbacks).forEach((e=>e())),clearTimeout(this.depthTimeout),this.depthTimeout=setTimeout((()=>{this.depth=0}),0)}))}observe(){this.item.observe(t.body,{subtree:!0,childList:!0,characterData:!0,attributes:!0,attributeFilter:["class"]})}start(e,t){this.callbacks[e]=t,this.started||(this.observe(),this.started=!0)}},q=j.bind(null,"text-insert",((e,t)=>e.textContent===t||(e.textContent=t))),R=j.bind(null,"href-insert",((e,t)=>e.getAttribute("href")===t.trim()||e.setAttribute("href",t.trim()))),O=j.bind(null,"image-insert",((e,t)=>e.getAttribute("src")===t.trim()||e.setAttribute("src",t.trim()))),P=j.bind(null,"html-replace",((e,t)=>e.innerHTML===t||(e.innerHTML=t))),A=j.bind(null,"css-insert",(function(e,t){try{const n=t.trim().split(";");for(const t of n)if(t){const[n,r]=y(t,":");n&&void 0!==r&&(e.style[n]=r)}}catch(e){}})),C=(e,t,n)=>{j("js-insert",x.bind(null,t),e,n)};let L=!1;function $(t,n){return new Promise((r=>{var i;const s=y(t,".")[1];if(s)try{null===(i=e.ym)||void 0===i||i.call(e,s,"experiments",n)}catch(e){}!function i(){if(!s)return void console.error(`Bad clientId = ${t}`);const o=function(t){var n,r;const i=e[`yaCounter${t}`];if(!i)try{const i=(null===(r=null===(n=e.Ya)||void 0===n?void 0:n._metrika)||void 0===r?void 0:r.counters)||{};return i[Object.keys(i).find((e=>0===e.indexOf(`${t}:`)))||""]}catch(e){}return i}(s);if(o){try{o.experiments(n)}catch(e){}L=!0,r(!0)}else setTimeout(i,10)}()}))}function M(t,n=e.location.href){if(0===t.length)return;const r=new URL(n),i=r.pathname;r.pathname="";const s=new URL(t,r.toString());s.protocol=r.protocol,s.hostname=r.hostname;let o=0,a=!0;return r.searchParams.forEach(((e,t)=>{"ab__exp_flags"!==t&&"vq__redir_param"!==t&&(o++,s.searchParams.has(t)?a&&s.searchParams.get(t)!==e&&(a=!1):s.searchParams.set(t,e))})),a&&(a=o===Array.from(s.searchParams.keys()).length),a&&i.replace(m,"")===s.pathname.replace(m,"")?void 0:s}function N(t,n,r,i){if(n)switch(t.storeRedirParam){case!0:case"localstorage":const t={experiments:n,ts:Date.now(),target:r.toString()};e.localStorage.setItem("vq__redirect_param",JSON.stringify(t));break;case"cookie":v("vq__redir_param",n,5*d);break;case"get":r.searchParams.set("vq__redir_param",n);break;default:i()}}function H(t,n,r){if("string"!=typeof r||0===r.length)return;let i=r;try{const s=new URL(r,e.location.href);N(t,n,s,(()=>console.error("storeRedirParam is required"))),i=s.toString()}catch(e){console.error(e)}return i}function J(e,t,n){let r=6,i=0;!function e(){var s;try{for(;i<n.length;i++)null===(s=n[i])||void 0===s||s.call(null,t)}catch(t){r-- >0?setTimeout(e,50):console.error(t)}}(),function(e){if(!b||"object"!=typeof b)return;!0===b[e]&&(b[e]=!1);const{callback:t}=b;if(t){for(const[e,t]of Object.entries(b)){const[n,r]=y(e,".");if(n&&r&&!0===t&&n.length>0&&!isNaN(Number(r)))return}setTimeout(t,0)}}(e)}function U(n,r,c,m){if("string"!=typeof n)throw new Error("clientId: should be string");o[n]=!0;let b=10;const y=new URL(u),x=y.searchParams;x.set("client_id",String(n)),x.set("url",e.location.href),x.set("i",r||g(f)||""),c&&x.set("client_features",JSON.stringify(c));const T=y.toString(),w=s[T];if(w)return m(w);const I=i[T]||(i[T]=[]);if(I.push(m),I.length>1)return;function k(){if(s[T])return;const e={flags:{},i:r,experiments:void 0,prepareUrl:e=>"string"==typeof e?e:void 0};s[T]=e,$(n,"wSIKtymTfos,"),I&&J(n,e,I)}const j=setTimeout(k,5e3);function U(i){var o,c;const u=l[n]||a,{flags:m,cssInsert:b,textInsert:y,hrefInsert:x,jsInsert:w,imageSrcInsert:k,redirect:U,htmlReplace:F,adv:D}=_(i.flags,u),V=Object.assign(Object.assign({},i),{flags:m,prepareUrl:H.bind(null,u,i.experiments)});i.i&&(r=i.i);const W=function(t){try{switch(t){case"cookie":{const e=g("vq__redir_param");return v("vq__redir_param","",-h),e}case"get":{const t=new URL(e.location.href),n=t.searchParams;if(n.has("vq__redir_param")){const r=n.get("vq__redir_param");return n.delete("vq__redir_param"),e.history.replaceState(e.history.state,"",t.toString()),r||void 0}}case"localstorage":case!0:{const t=e.localStorage.getItem("vq__redirect_param");let n;if(t){const e=JSON.parse(t);e.ts>Date.now()-5*d&&(n=e.experiments)}else n=e.localStorage.getItem("vq__redir_param")||void 0;return e.localStorage.removeItem("vq__redir_param"),e.localStorage.removeItem("vq__redirect_param"),n||void 0}}}catch(e){}}(u.storeRedirParam);function B(e=!1){F.length&&P(F,e),x.length&&R(x,e),k.length&&O(k,e),y.length&&q(y,e),b.length&&A(b,e),w.length&&C(w,u.nonce,e)}W&&W!==i.experiments?$(n,W).then((()=>$(n,i.experiments))):$(n,i.experiments),clearTimeout(j),s[T]=V,V.i&&v(f,V.i),U.length&&function(t,n,r){let i;for(const e of t)if(i=M(e),i)break;if(!i)return!1;let s=0;try{N(n,r,i,(()=>s=n.metrikaTimeout))}catch(e){s=n.metrikaTimeout}const o=i.toString();let a,c;function l(){clearTimeout(c),clearTimeout(a),e.location.replace(o)}return c=setTimeout(l,s),function e(){L?l():a=setTimeout(e,10)}(),!0}(U,u,i.experiments)||(p((function(){u.enableVisual&&(b.length&&function(e,n){const r=[];for(const{selector:t,value:n}of e){const e=n.trim();r.push(`${t} {${e}}`)}try{const e=t.createElement("style");e.nonce=n,e.setAttribute("type","text/css"),e.textContent=r.join("\n").replace(/;/g," !important;"),t.body.appendChild(e)}catch(e){}}(b,u.nonce),u.enableWatch&&E.start(n,B),B(!u.enableWatch)),I&&J(n,V,I)})),D.length&&(e.yaContextCb||(e.yaContextCb=[]),(null===(c=null===(o=e.Ya)||void 0===o?void 0:o.Context)||void 0===c?void 0:c.AdvManager)||S("https://yandex.ru/ads/system/context.js"),p((function(){for(const{type:t,value:n}of D)try{const r=JSON.parse(n);if("object"!=typeof r||null===r)continue;e.yaContextCb.push((()=>{var n,i;const s=null===(i=null===(n=e.Ya)||void 0===n?void 0:n.Context)||void 0===i?void 0:i.AdvManager;if(!s)return;const o=s.getPlatform(),a=r[o];a&&a.id&&s.render({type:t,platform:o,blockId:a.id,renderTo:a.renderTo})}))}catch(e){}}))))}F(T,U,(function e(){if(--b>0)return F(T,U,e);clearTimeout(j),k()}))}function F(e,t,n){const r=new XMLHttpRequest;return r.open("GET",e),r.addEventListener("load",(function(){if(200!==r.status)n(r.statusText);else try{const e=JSON.parse(r.responseText);t(e)}catch(e){e instanceof Error&&n(e.message)}})),r.addEventListener("error",(()=>n(r.statusText))),r.send()}const D={init:(e,t,n,r)=>{U(e,t,n,(e=>r&&r(e)))},getFlags:(e,t,n,r)=>{U(e,t,n,(e=>r&&r(e.flags)))},getExperiments:(e,t,n,r)=>{U(e,t,n,(e=>r&&r(e.experiments)))},getParam:(e,t,n,r)=>{U(e,t,n,(e=>r&&r(e.i)))},setConfig:(e,t,n,r)=>{V(e,n),r&&r()},getConfig:(e,t,n,r)=>{const i=l[e]||a,s=Object.assign({},i);delete s.nonce,r&&r(s)}};function V(e,t){var n;if("object"==typeof t){const r=l[e]||(l[e]=Object.assign({},a)),i=Object.keys(t);for(const e of i)if(e in r){const i=e,s=t[i];(null===(n=c[i])||void 0===n?void 0:n.includes(typeof s))&&(r[i]=s)}}}function W(e,t,n,r,i){if("object"==typeof e)return function(e){const{clientId:t,config:n}=e;if(!t)throw new Error("clientId is required");V(t,n),D.init(t,e.i,e.clientFeatures,e.callback)}(e);if(!t)throw new Error("method not specified");if(!(t in D))throw new Error("unknown method");"function"==typeof r&&(i=r,r={}),"function"==typeof n&&(i=n,n=void 0),"object"==typeof n&&(r=n,n=void 0),r||(r={}),D[t](e,n,r,i)}e.ymab&&(Array.isArray(e.ymab.a)&&e.ymab.a.forEach((e=>W.apply(null,e))),"object"==typeof e.ymab.antiFlicker&&(b=e.ymab.antiFlicker)),W.inited=!0,e.ymab=W,function(e){const t=["ru","ua","by","kz","com","com.tr"];function n(e){(function(e){return Boolean(e&&/^https:\/\/abt\.s3\.yandex\.net\/(\w|-|\/|(\.)(?!\.))+\.js$/.test(e))})(e)&&S(e)}function r(e){const n=new URL(e),{hostname:r,protocol:i}=n,s=(null==r?void 0:r.split("."))||[];"test"===s[1]&&s.splice(1,1);const[o,a,...c]=s,l=c.join(".");return"https:"===i&&"ab"===o&&"yandex"===a&&-1!==t.indexOf(l)}e.addEventListener("message",(function(e){const t=e.origin;if(!t||!r(t))return;const i=function(e){if(!e)return null;if("string"!=typeof e)return e;try{return JSON.parse(e)}catch(e){return null}}(e.data);var s,a;if(i&&o[i.clientId])switch(i.type){case"appendremote":n(i.url);break;case"appendplugin":s=i.plugin,a=i.version,/^(\d\.)+\d$/.test(a)&&/^[a-z0-9-]+$/gi.test(s)&&S(`https://abt.s3.yandex.net/${s}/v${a}/main.js`)}}))}(e)}(window,document);